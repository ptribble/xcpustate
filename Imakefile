        DEPLIBS = $(DEPXAWLIB) $(DEPXMULIB) $(DEPXTOOLLIB) $(DEPXLIB)
LOCAL_LIBRARIES = $(XAWLIB) $(XMULIB) $(XTOOLLIB) $(XLIB)
           SRCS = xcpustate.c Bar.c s.c rstat.c rstat_clnt.c rstat_xdr.c
           OBJS = xcpustate.o Bar.o s.o rstat.o rstat_clnt.o rstat_xdr.o
   INSTPGMFLAGS = InstPgmFlags InstKmemFlags
/*
 *  Things to consider adding to DEFINES:
 *
 *  -DRSTAT -- support the rstat protocol for querying the rstatd running
 *             on remote machines (using the -host option).  There's no harm 
 *             in leaving this in, unless you think your users will query
 *             machines they shouldn't.
 *  -DSHOWAVG -- this has no effect except on Linux machines.  If defined,
 *             a CPU bar showing the "average" CPU will be added.  
 *  -DDEF_FONT -- the default font.  Leave this alone unless you don't want
 *             to use the X default font (XtdefaultFont).  To force
 *             a particular font, e.g. 9x15, -DDEF_FONT=\"9x15" will work.
 *  -DDEF_INTERVAL -- the default update interval, normally 1 second.  This is
 *             used when one isn't specified via the command line or an X 
 *             resource. e.g. -DDEF_INTERVAL=2.5
 *  -DINTERVAL_MIN -- the minimum interval, normally 0 seconds.  Set this
 *             to something greater to keep xcpustate from overloading your
 *             network or x-server with traffic, which it can easily do if
 *             a small interval (e.g. 0.01 seconds) is specified.  For example,
 *             to prevent intervals less than half a second, use 
 *             -DINTERVAL_MIN=0.5
 */
        DEFINES = $(SYSTYPE) -DRSTAT

#if defined(MACH)
  SYS_LIBRARIES = -lmach
s.c: s-mach.c
#endif /* MACH */

#if defined(SparcArchitecture) && OSMajorVersion == 4
  SYS_LIBRARIES = -lkvm
        /* add -DOMNI if you have OMNI nc400s */
        SYSTYPE = -DSUNOS4
s.c: s-sunos4.c
#endif

#if defined(SVR4)
  SYS_LIBRARIES = -lelf
#endif

#if defined(SGIArchitecture) 
        SYSTYPE = -DIRIX
s.c: s-irix.c
#endif

#if ( defined(SunArchitecture) || defined(SparcArchitecture)) && OSMajorVersion == 5
  SYS_LIBRARIES = -lkstat -lelf
        SYSTYPE = -DSUNOS5
   INSTPGMFLAGS = InstPgmFlags 
s.c: s-sunos5.c
#endif

#if defined(AIXArchitecture) || defined(_AIX) || defined(AIX) || defined(aix)
s.c: s-aix.c
#if OSMajorVersion > 3
        SYSTYPE = -DSMP
#endif 
#endif

#if defined (FreeBSDArchitecture) || defined(NetBSDArchitecture) 
s.c: s-bsd44.c
  SYS_LIBRARIES = -lkvm
#endif

#if defined(OpenBSDArchitecture) 
#if OSMajorVersion < 3
  SYS_LIBRARIES = -lkvm
s.c: s-bsd44.c
#else
s.c: s-openbsd.c 
#endif 
#endif 

#if defined (cygwinArchitecture)
    SYS_LIBRARIES = -lrpc -lxpm
s.c: s-cygwin.c
#endif

ComplexProgramTarget(xcpustate)

rstat.c: rstat.h

rstat.h rstat_clnt.c rstat_xdr.c: rstat.x
	rpcgen rstat.x

xcpustate.c: levels.h

shar:
	shar `awk '{print $$1}' MANIFEST` >xcpustate-`awk '{print $$7;exit}' patchlevel.h`.shar

veryclean: clean
	$(RM) rstat_* rstat.h xcpustate-*.shar Makefile
